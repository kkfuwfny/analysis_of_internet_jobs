import urllib2
import urllib
import socket
import re
socket.setdefaulttimeout(5)
url = 'http://search.51job.com/list/000000%252C00,000000,0100%252C2500%252C2811%252C2600%252C2700,01%252C40%252C32%252C38,9,99,%2B,2,'

try:
    for i in range(1,1000):
        newurl = url + str(i) + ',html'
        print newurl
        page = urllib2.urlopen(newurl).read().decode('gbk')
        jobhref = re.findall('<td class="td1"><a adid="".*?href="(.*?)"',page)
        f = open('ran.txt','r+')
        for h in jobhref:
            f.write(h + '\n')
        f.close()
	newurl = ''
        
except urllib2.HTTPError,e:
    print 'Error code:',e.code
except urllib2.URLError,e:
    print 'Reason:',e.reason
except socket.timeout as e:
    print  'timeout'
